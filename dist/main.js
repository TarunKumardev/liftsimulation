(()=>{let e=document.querySelectorAll(".liftCallBtn"),t=document.querySelectorAll(".liftContainer");const n=document.querySelector(".floors");let l=document.querySelectorAll(".floor");const o=document.querySelector(".floorInput"),r=document.querySelector(".liftInput"),i=document.querySelector(".errorMsg"),c=document.querySelector(".backButton"),u=document.querySelector(".simulateBtn");document.querySelector(".simulationContainer");let s=document.querySelectorAll(".leftDoor"),a=document.querySelectorAll(".rightDoor");const d=Array.from(document.querySelectorAll(".liftContainer"),(e=>({el:e,isAvailable:!0,currentFloor:0}))),f=()=>{const{lift:e,index:t}=function(e){const t=d.reduce(((t,n,l)=>(!0===n.isAvailable&&t.push({i:l,currentFloor:n.currentFloor,distance:Math.abs(e-n.currentFloor)}),t)),[]);if(t.length<=0)return{lift:{},index:-1};const n=t.reduce(((e,t)=>t.distance<e.distance?t:e)).i;return{lift:d[n],index:n}}(v[v.length-1]);if(t>=0){let n;d[t].isAvailable=!1,v.length>0&&(n=v.shift()),y(e.el,n,t)}},m=e=>{(e=>{a[e].classList.add("rightDoor__open"),s[e].classList.add("leftDoor__open")})(e),setTimeout((()=>{(e=>{a[e].classList.remove("rightDoor__open"),s[e].classList.remove("leftDoor__open"),setTimeout((()=>{d[e].isAvailable=!0,document.dispatchEvent(q)}),2500)})(e)}),3e3)},y=(e,t,n)=>{const l=e.clientHeight+1,o=Math.abs(t-d[n].currentFloor);e.style.transform=`translateY(-${t*l}px)`,e.style.transition=`transform ${2e3*o}ms linear`,setTimeout((()=>{m(n)}),2e3*o+1e3),d[n].currentFloor=t};let v=[];const h=new Event("requestAdded"),q=new Event("liftIdle");function p(e){for(let t=0;t<e.length;t++)e[t].addEventListener("click",(()=>{var n;n=e[t].dataset.liftNum,v.push(n),document.dispatchEvent(h)}))}function S(e){const t=document.querySelector(".mainSection"),n=document.querySelector(".formContainer");t.style.display=e?"block":"none",n.style.display=e?"none":"block"}document.addEventListener("requestAdded",(()=>{f()})),document.addEventListener("liftIdle",(()=>{0!==v.length&&f()})),c.addEventListener("click",(()=>S(!1))),u.addEventListener("click",(function(){const c=o.value,u=r.value;if(function(e,t){const n=window.innerWidth,l=n<450?70:130,o=Math.floor(n/l);return i.textContent=null,e<t?(i.textContent="Floors must be greater than elevators",!1):t<1?(i.textContent="At least 1 elevator is required",!1):!(t>o&&(i.textContent=`Max ${o} elevators are allowed`,1))}(c,u)){S(!0),n.innerHTML="",p(e);for(let t=0;t<c;t++)n.prepend(function(){const e=l.length,t=document.createElement("div");return t.classList.add("floor"),t.innerHTML+=`\n          <div class="liftButtons">\n          <button class="liftCallBtn liftUpBtn" data-lift-num="${e}">\n            up\n          </button>\n          <button class="liftCallBtn liftDownBtn" data-lift-num="${e}">\n            down\n          </button>\n        </div>\n                `,0===e&&(t.querySelector(".liftDownBtn").style.display="none"),e===o.value-1&&(t.querySelector(".liftUpBtn").style.display="none"),t}()),l=document.querySelectorAll(".floor"),e=document.querySelectorAll(".liftCallBtn"),p([e[0],e[1]]);for(let e=0;e<u;e++)l[l.length-1].append(function(){const e=document.createElement("div");return e.classList.add("liftContainer"),e.innerHTML+='\n            <div class="leftDoor">\n            </div>\n            <div class="rightDoor">\n            </div>\n        ',e}()),t=document.querySelectorAll(".liftContainer"),d.push({el:t[t.length-1],isAvailable:!0,currentFloor:0}),a=document.querySelectorAll(".rightDoor"),s=document.querySelectorAll(".leftDoor")}}))})();